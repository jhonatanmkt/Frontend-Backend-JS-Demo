<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Tramitação Legislativa JS</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --panel-color: #16213e;
            --accent-color: #0f3460;
            --highlight: #e94560;
            --text-color: #e0e0e0;
            --success: #2ecc71;
            --warning: #f1c40f;
        }

        body {
            font-family: 'Consolas', 'Courier New', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            width: 90%;
            max-width: 900px;
            height: 600px;
        }

        /* Painel Principal */
        .main-panel {
            background-color: var(--panel-color);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .status-header {
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .status-badge {
            background-color: var(--accent-color);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scenario-text {
            font-size: 1.2rem;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Área de Decisão (Botões) */
        .decision-area {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        button {
            background-color: transparent;
            border: 2px solid var(--highlight);
            color: var(--text-color);
            padding: 15px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
            border-radius: 4px;
        }

        button:hover {
            background-color: var(--highlight);
            color: white;
            transform: translateY(-2px);
        }

        button.reset {
            border-color: #555;
            margin-top: 10px;
            width: 100%;
        }

        /* Painel de Log (Lateral) */
        .log-panel {
            background-color: #0f1219;
            padding: 15px;
            border-radius: 8px;
            overflow-y: auto;
            border: 1px solid #333;
            font-size: 0.9rem;
        }

        .log-entry {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #222;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }

        .log-time {
            color: #666;
            font-size: 0.7rem;
        }

        .log-action {
            color: var(--success);
            font-weight: bold;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        /* Mobile */
        @media (max-width: 700px) {
            .dashboard { grid-template-columns: 1fr; height: auto; }
            .log-panel { max-height: 200px; }
        }
    </style>
</head>
<body>

    <div class="dashboard">
        <!-- Painel Esquerdo: Jogo -->
        <div class="main-panel">
            <div class="status-header">
                <span class="status-badge" id="location-badge">Início</span>
                <h2 id="title-display">Nova Proposta de Lei</h2>
            </div>
            
            <div class="scenario-text" id="text-display">
                Carregando sistema legislativo...
            </div>

            <div class="decision-area" id="buttons-container">
                <!-- Botões inseridos via JS -->
            </div>
        </div>

        <!-- Painel Direito: Histórico -->
        <div class="log-panel" id="log-container">
            <div style="color: #555; text-align: center;">-- Log do Sistema --</div>
        </div>
    </div>

<script>
    /**
     * ESTRUTURA DE DADOS (State Machine)
     * Cada chave é um "Estado" da lei.
     * Contém o texto descritivo e as ações possíveis (transições).
     */
    const scenarios = {
        inicio: {
            title: "Origem da Ideia",
            location: "Sociedade / Gabinete",
            text: "Uma nova ideia de lei surgiu. Quem é o autor dessa proposta?",
            options: [
                { label: "Deputado Federal", next: "camara_inicio", action: "Protocolada na Câmara" },
                { label: "Senador", next: "senado_inicio", action: "Protocolada no Senado" },
                { label: "Presidente", next: "camara_inicio", action: "Mensagem do Executivo enviada" }
            ]
        },
        // --- CAMINHO COMEÇANDO NA CÂMARA ---
        camara_inicio: {
            title: "Câmara dos Deputados (Casa Iniciadora)",
            location: "Brasília - Câmara",
            text: "O projeto está sendo analisado pelas comissões (CCJ, Finanças, etc). Parecer favorável. Vai a plenário para votação.",
            options: [
                { label: "Aprovar Projeto", next: "senado_revisora", action: "Aprovado pela Maioria na Câmara" },
                { label: "Rejeitar Projeto", next: "arquivado", action: "Rejeitado em Plenário" },
                { label: "Aprovar com Mudanças", next: "senado_revisora", action: "Aprovado com Emendas" }
            ]
        },
        // --- SENADO COMO REVISOR ---
        senado_revisora: {
            title: "Senado Federal (Casa Revisora)",
            location: "Brasília - Senado",
            text: "O projeto chegou da Câmara. Os senadores estão analisando. Se mudarem o texto, tem que voltar!",
            options: [
                { label: "Aprovar sem mudanças", next: "mesa_presidente", action: "Senado aprovou integralmente" },
                { label: "Alterar texto (Emenda)", next: "volta_camara", action: "Senado alterou o texto" },
                { label: "Rejeitar Projeto", next: "arquivado", action: "Senado rejeitou a proposta" }
            ]
        },
        // --- VOLTA PARA CÂMARA (PING PONG) ---
        volta_camara: {
            title: "Retorno à Câmara",
            location: "Brasília - Câmara",
            text: "O Senado alterou o texto. A Câmara precisa decidir se aceita as mudanças do Senado ou mantém o texto original.",
            options: [
                { label: "Aceitar mudanças", next: "mesa_presidente", action: "Câmara aceitou emendas do Senado" },
                { label: "Recusar mudanças", next: "mesa_presidente", action: "Câmara manteve texto original" }
            ]
        },
        // --- CAMINHO COMEÇANDO NO SENADO ---
        senado_inicio: {
            title: "Senado Federal (Casa Iniciadora)",
            location: "Brasília - Senado",
            text: "Projeto proposto por um Senador. Passou pelas comissões e está em votação no plenário.",
            options: [
                { label: "Aprovar", next: "camara_revisora", action: "Aprovado no Senado" },
                { label: "Rejeitar", next: "arquivado", action: "Rejeitado pelos Senadores" }
            ]
        },
        camara_revisora: {
            title: "Câmara (Casa Revisora)",
            location: "Brasília - Câmara",
            text: "Deputados analisam o projeto que veio do Senado.",
            options: [
                { label: "Aprovar", next: "mesa_presidente", action: "Câmara confirmou aprovação" },
                { label: "Alterar (Emendar)", next: "volta_senado", action: "Câmara modificou o projeto" },
                { label: "Arquivar", next: "arquivado", action: "Câmara rejeitou o projeto do Senado" }
            ]
        },
        volta_senado: {
            title: "Retorno ao Senado",
            location: "Brasília - Senado",
            text: "Como a Câmara mexeu no texto, o Senado dá a palavra final sobre as alterações.",
            options: [
                { label: "Finalizar texto", next: "mesa_presidente", action: "Texto final consolidado" }
            ]
        },
        // --- O PRESIDENTE ---
        mesa_presidente: {
            title: "Mesa do Presidente",
            location: "Palácio do Planalto",
            text: "O projeto foi aprovado pelo Congresso! O Presidente tem 15 dias úteis para decidir.",
            options: [
                { label: "Sancionar (Assinar)", next: "lei_aprovada", action: "Presidente Sancionou" },
                { label: "Vetar Totalmente", next: "analise_veto", action: "Veto Presidencial Total" },
                { label: "Veto Parcial", next: "lei_aprovada_parcial", action: "Sanção com Veto Parcial" }
            ]
        },
        // --- DERRUBADA DE VETO ---
        analise_veto: {
            title: "Congresso Nacional (Análise de Veto)",
            location: "Congresso Nacional",
            text: "O Presidente vetou. O Congresso se reúne para decidir se aceita o veto ou o derruba.",
            options: [
                { label: "Aceitar Veto", next: "arquivado", action: "Congresso manteve o veto" },
                { label: "Derrubar Veto", next: "lei_promulgada_congresso", action: "Congresso derrubou o veto" }
            ]
        },
        // --- FINAIS ---
        arquivado: {
            title: "FIM DA LINHA",
            location: "Arquivo Morto",
            text: "O projeto foi rejeitado ou arquivado. Ele não virou lei.",
            options: [] // Sem opções, botão de reset será gerado automaticamente
        },
        lei_aprovada: {
            title: "HABEMUS LEI!",
            location: "Diário Oficial da União",
            text: "Parabéns! O projeto foi sancionado, promulgado e publicado. Agora é Lei Federal.",
            options: []
        },
        lei_aprovada_parcial: {
            title: "LEI (Com cortes)",
            location: "Diário Oficial da União",
            text: "A lei foi publicada, mas alguns trechos foram cortados pelo Presidente.",
            options: []
        },
        lei_promulgada_congresso: {
            title: "LEI (Apesar do Presidente)",
            location: "Congresso Nacional",
            text: "O Congresso derrubou a vontade do Presidente e promulgou a lei por conta própria.",
            options: []
        }
    };

    // --- CLASSE DO MOTOR DO JOGO ---
    class LegislativeEngine {
        constructor() {
            this.currentState = null;
            this.history = [];
            
            // Cache DOM elements
            this.ui = {
                title: document.getElementById('title-display'),
                text: document.getElementById('text-display'),
                badge: document.getElementById('location-badge'),
                buttons: document.getElementById('buttons-container'),
                log: document.getElementById('log-container')
            };
        }

        start() {
            this.transitionTo('inicio');
            this.log("Simulação iniciada.", "SISTEMA");
        }

        transitionTo(stateId) {
            const scenario = scenarios[stateId];
            if (!scenario) return console.error("Estado inválido:", stateId);

            this.currentState = scenario;
            this.render();
        }

        // Gera a interface baseada no objeto JSON
        render() {
            const { title, text, location, options } = this.currentState;

            // Atualiza Textos com efeito de digitação simples (opcional)
            this.ui.title.innerText = title;
            this.ui.text.innerText = text;
            this.ui.badge.innerText = location;

            // Limpa botões antigos
            this.ui.buttons.innerHTML = '';

            // Verifica se é um estado final (sem opções)
            if (options.length === 0) {
                this.createResetButton();
            } else {
                // Cria botões dinamicamente
                options.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.innerText = opt.label;
                    btn.onclick = () => {
                        this.log(opt.action, "AÇÃO");
                        this.transitionTo(opt.next);
                    };
                    this.ui.buttons.appendChild(btn);
                });
            }
        }

        createResetButton() {
            const btn = document.createElement('button');
            btn.innerText = "Reiniciar Simulação";
            btn.classList.add('reset');
            btn.onclick = () => {
                this.ui.log.innerHTML = '<div style="color: #555; text-align: center;">-- Log do Sistema --</div>';
                this.start();
            };
            this.ui.buttons.appendChild(btn);
        }

        log(message, type) {
            const entry = document.createElement('div');
            entry.classList.add('log-entry');
            
            const time = new Date().toLocaleTimeString();
            
            entry.innerHTML = `
                <div class="log-time">[${time}] ${type}</div>
                <div class="log-action">${message}</div>
            `;
            
            // Adiciona no topo ou fim (prepend vs append)
            this.ui.log.insertBefore(entry, this.ui.log.children[1]);
        }
    }

    // Inicializar o App
    const app = new LegislativeEngine();
    app.start();

</script>

</body>
</html>